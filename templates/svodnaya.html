{% extends 'base.html' %}
{% block title %}–°–≤–æ–¥–Ω–∞—è –ø–æ —Å–≤–∞–¥—å–±–∞–º{% endblock %}

{% block content %}
<h2 class="text-2xl font-extrabold mb-6 flex items-center gap-2">
  <span>üìä</span> –°–≤–æ–¥–Ω–∞—è –ø–æ —Å–≤–∞–¥—å–±–∞–º
</h2>

{# ‚Äî‚Äî‚Äî –í–µ—Ä—Ö–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏-–∏—Ç–æ–≥–∏ ‚Äî‚Äî‚Äî #}
<div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
  <div class="bg-white rounded-2xl border border-pink-100 p-5 shadow">
    <div class="text-gray-500 text-sm">–í—Å–µ–≥–æ —Å–≤–∞–¥–µ–±</div>
    <div class="text-2xl font-black">{{ weddings|length }}</div>
  </div>
  <div class="bg-white rounded-2xl border border-emerald-100 p-5 shadow">
    <div class="text-gray-500 text-sm">–°—É–º–º–∞ –≤—Å–µ—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤</div>
    <div class="text-2xl font-black text-emerald-700">
      {{
        ('{:,.0f}'.format((weddings | sum(attribute='total')) or 0)).replace(',', ' ')
      }} —Å—É–º
    </div>
  </div>
  <div class="bg-white rounded-2xl border border-indigo-100 p-5 shadow">
    <div class="text-gray-500 text-sm">–°—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥ –Ω–∞ —Å–≤–∞–¥—å–±—É</div>
    <div class="text-2xl font-black text-indigo-700">
      {% set _cnt = weddings|length %}
      {% set _sum = (weddings | sum(attribute='total')) or 0 %}
      {{ ('{:,.0f}'.format((_sum // _cnt) if _cnt else 0)).replace(',', ' ') }} —Å—É–º
    </div>
  </div>
</div>

{# ‚Äî‚Äî‚Äî –¢–∞–±–ª–∏—Ü–∞ ‚Äî‚Äî‚Äî #}
<div class="overflow-x-auto">
  <table class="min-w-full bg-white rounded-2xl border shadow text-sm">
    <thead class="bg-pink-50">
      <tr>
        <th class="px-4 py-3 text-left font-bold">–ù–∞–∑–≤–∞–Ω–∏–µ</th>
        <th class="px-4 py-3 text-left font-bold">–î–∞—Ç–∞</th>
        <th class="px-4 py-3 text-right font-bold">–í—Å–µ–≥–æ —Ä–∞—Å—Ö–æ–¥–æ–≤</th>
      </tr>
    </thead>
    <tbody>
      {% for w in weddings %}
      <tr class="border-t hover:bg-pink-50/70 transition">
        <td class="px-4 py-3 font-semibold">
          <a href="{{ url_for('wedding_pages.view_wedding', wedding_id=w.id) }}"
             class="text-pink-700 hover:text-pink-900 hover:underline">
            {{ w.name }}
          </a>
        </td>
        <td class="px-4 py-3">
          {% if w.date %}{{ w.date.strftime('%d.%m.%Y') }}{% else %}‚Äî{% endif %}
        </td>
        <td class="px-4 py-3 text-right font-bold">
          {{ ('{:,.0f}'.format(w.total or 0)).replace(',', ' ') }} —Å—É–º
        </td>
      </tr>
      {% endfor %}
    </tbody>
    <tfoot class="bg-pink-50/60">
      <tr>
        <td class="px-4 py-3 font-bold">–ò—Ç–æ–≥–æ</td>
        <td class="px-4 py-3"></td>
        <td class="px-4 py-3 text-right font-black text-pink-700">
          {{
            ('{:,.0f}'.format((weddings | sum(attribute='total')) or 0)).replace(',', ' ')
          }} —Å—É–º
        </td>
      </tr>
    </tfoot>
  </table>
</div>
{% endblock %}
