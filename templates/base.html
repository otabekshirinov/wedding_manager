<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>{% block title %}üíí –°–≤–∞–¥–µ–±–Ω—ã–π –ü–æ–º–æ—â–Ω–∏–∫{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Tailwind + Inter -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;900&display=swap" rel="stylesheet" />

  <!-- FAVICONs -->
  <link rel="icon" type="image/svg+xmL" href="{{ url_for('static', filename='favicon.svg') }}">
  <!-- (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) png-—Ñ–æ–ª–±—ç–∫–∏, –µ—Å–ª–∏ –¥–æ–±–∞–≤–∏—à—å —Ñ–∞–π–ª—ã: -->
  <!-- <link rel="icon" sizes="32x32" href="{{ url_for('static', filename='favicon-32.png') }}"> -->
  <!-- <link rel="apple-touch-icon" href="{{ url_for('static', filename='apple-touch-icon.png') }}"> -->
  <meta name="theme-color" content="#ec4899">

  <style>
  html { font-family: 'Inter', sans-serif; }

  /* ====== —É—Ç–∏–ª–∏—Ç—ã ====== */
  .glass{background:rgba(255,255,255,.84);box-shadow:0 6px 32px 0 #fbcfe855;backdrop-filter:blur(16px);border-radius:18px}
  .wedding-card{background:#fff;border:1.5px solid #fbcfe8;border-radius:18px;box-shadow:0 4px 16px 0 #d946ef0a;transition:box-shadow .2s,border .2s}
  .wedding-card:hover{box-shadow:0 8px 28px 0 #e879f930;border-color:#f472b6}
  .btn{display:inline-flex;align-items:center;gap:.5rem;border-radius:12px;padding:.6rem 1rem;font-weight:700}
  .btn-primary{background:#ec4899;color:#fff}.btn-primary:hover{background:#db2777}
  .btn-soft{background:#f1f5f9;color:#111827}.btn-soft:hover{background:#e5e7eb}
  .chip{display:inline-block;border-radius:999px;padding:.15rem .6rem;font-size:.75rem;font-weight:700}
  .wedding-title-glow{text-shadow:0 2px 16px #f9a8d4bb,0 1px 0 #fff}
  @media (max-width:640px){.hero-title{font-size:2rem!important}}

  /* ====== –º—è–≥–∫–∞—è –∞—É—Ä–∞ —Ñ–æ–Ω–∞ ====== */
  .bg-aurora{
    position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden;
    background:
      radial-gradient(900px 520px at 12% -10%, rgba(255,228,241,.85) 0, transparent 60%),
      radial-gradient(800px 480px at 110% -20%, rgba(233,213,255,.90) 0, transparent 55%),
      linear-gradient(120deg,#f8fafc 0%,#fff1f7 50%,#e0c3fc 100%);
    filter:saturate(1.06) contrast(1.02);
    animation:aurora-move 18s ease-in-out infinite alternate;
  }
  @keyframes aurora-move{
    0%{background-position:0 0,0 0,0 0}
    50%{background-position:-60px -30px,30px -20px,0 0}
    100%{background-position:-110px -60px,60px -40px,0 0}
  }

  /* ====== –ø—É–∑—ã—Ä–∏–∫–∏ ====== */
  .bg-decor{
    position:fixed;inset:0;z-index:1;pointer-events:none;overflow:hidden;
    isolation:isolate;
  }
  .bubble{
    position:absolute;left:var(--left,50%);bottom:-12vmin;
    width:var(--size,40px);height:var(--size,40px);border-radius:50%;
    background:
      radial-gradient(circle at 30% 30%, rgba(255,255,255,.95), rgba(255,255,255,.25) 40%, rgba(255,255,255,0) 60%),
      radial-gradient(circle at 70% 80%, rgba(236,72,153,.18), rgba(99,102,241,.12) 60%, transparent 70%);
    border:1px solid rgba(255,255,255,.45);
    box-shadow:
      inset 0 0 14px rgba(255,255,255,.55),
      0 10px 28px rgba(236,72,153,.10),
      0 8px 20px rgba(99,102,241,.12);
    opacity:.92;
    animation:bubble-rise var(--dur,26s) linear var(--delay,0s) infinite;
    will-change:transform,opacity;
    backface-visibility:hidden;
  }
  .bubble::after{
    content:"";position:absolute;inset:-10%;border-radius:50%;pointer-events:none;
    background:
      radial-gradient(circle at 30% 30%, rgba(255,255,255,.75), rgba(255,255,255,0) 55%),
      radial-gradient(circle at 70% 80%, rgba(236,72,153,.22), rgba(99,102,241,.16) 60%, transparent 70%);
    mix-blend-mode:screen;
    -webkit-mask-image:radial-gradient(circle,#000 64%, rgba(0,0,0,0) 68%);
            mask-image:radial-gradient(circle,#000 64%, rgba(0,0,0,0) 68%);
  }
  @keyframes bubble-rise{
    0%   { transform:translateY(0) translateX(0) scale(1); opacity:0 }
    10%  { opacity:.92 }
    50%  { transform:translateY(-55vh) translateX(calc(var(--sway,12vw)*-.5)) scale(1.04) }
    100% { transform:translateY(-115vh) translateX(var(--sway,12vw)) scale(1); opacity:0 }
  }

  @media (prefers-reduced-motion:reduce){
    .bg-aurora{animation:none}
    .bubble{animation:none}
  }
  </style>

  {% block head_extra %}{% endblock %}
</head>
<body class="min-h-screen text-gray-800 overflow-x-hidden">
  <!-- –§–æ–Ω -->
  <div class="bg-aurora" aria-hidden="true"></div>
  <div class="bg-decor" aria-hidden="true"></div>

  <!-- NAVBAR -->
  <nav class="glass sticky top-0 z-30 px-3 sm:px-6 py-3">
    <div class="max-w-6xl mx-auto flex items-center justify-between">
      <div class="flex items-center gap-2">
        <span class="text-2xl sm:text-3xl">üè∞</span>
        <a href="{{ url_for('index') }}"
           class="font-black text-lg sm:text-2xl tracking-tight hover:text-pink-600 transition"
           style="letter-spacing:.03em; text-decoration:none;">
          –°–≤–∞–¥–µ–±–Ω—ã–π –ü–æ–º–æ—â–Ω–∏–∫
        </a>
      </div>

      <div class="hidden md:flex items-center gap-6">
        <a href="{{ url_for('index') }}" class="font-semibold hover:text-pink-600 transition">–°–≤–∞–¥—å–±—ã</a>
        <a href="{{ url_for('svodnaya_bp.svodnaya') }}" class="font-semibold hover:text-indigo-600 transition">–°–≤–æ–¥–Ω–∞—è</a>

        {% if current_user.is_authenticated %}
          {% if current_user.is_admin %}
            <a href="{{ url_for('admin.users') }}"
               class="chip bg-amber-100 text-amber-800 border border-amber-200"
               title="–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å">–ê–¥–º–∏–Ω</a>
          {% endif %}
          <div x-data="{open:false}" class="relative">
            <button @click="open=!open" class="btn btn-soft">
              <span class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-pink-500 text-white font-black">
                {{ (current_user.name or current_user.email)[:1] | upper }}
              </span>
              <span class="hidden sm:block font-semibold">{{ current_user.name or current_user.email }}</span>
              <svg class="w-4 h-4 opacity-70" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-width="2" d="M6 9l6 6 6-6"/></svg>
            </button>
            <div x-show="open" @click.outside="open=false"
                 class="absolute right-0 mt-2 w-56 bg-white rounded-xl shadow-xl border border-slate-100 overflow-hidden">
              <a href="{{ url_for('index') }}" class="block px-4 py-2 hover:bg-slate-50">–ú–æ–∏ —Å–≤–∞–¥—å–±—ã</a>
              <a href="{{ url_for('svodnaya_bp.svodnaya') }}" class="block px-4 py-2 hover:bg-slate-50">–°–≤–æ–¥–Ω–∞—è</a>
              {% if current_user.is_admin %}
                <a href="{{ url_for('admin.users') }}" class="block px-4 py-2 hover:bg-slate-50">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
              {% endif %}
              <div class="h-px bg-slate-100"></div>
              <a href="{{ url_for('auth.logout') }}" class="block px-4 py-2 text-rose-600 hover:bg-rose-50">–í—ã–π—Ç–∏</a>
            </div>
          </div>
        {% else %}
          <a href="{{ url_for('auth.login') }}" class="btn btn-soft">–í–æ–π—Ç–∏</a>
          <a href="{{ url_for('auth.register') }}" class="btn btn-primary">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
        {% endif %}
      </div>

      <button class="md:hidden p-2 rounded-lg bg-white/70 border"
              onclick="document.getElementById('mobile-menu').classList.toggle('hidden')"
              aria-label="–ú–µ–Ω—é">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
      </button>
    </div>

    <div id="mobile-menu" class="hidden md:hidden mt-3">
      <div class="max-w-6xl mx-auto bg-white rounded-xl shadow border overflow-hidden">
        <a href="{{ url_for('index') }}" class="block px-6 py-3 font-semibold hover:bg-pink-50">–°–≤–∞–¥—å–±—ã</a>
        <a href="{{ url_for('svodnaya_bp.svodnaya') }}" class="block px-6 py-3 font-semibold hover:bg-indigo-50">–°–≤–æ–¥–Ω–∞—è</a>
        {% if current_user.is_authenticated %}
          {% if current_user.is_admin %}
            <a href="{{ url_for('admin.users') }}" class="block px-6 py-3 hover:bg-amber-50">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
          {% endif %}
          <a href="{{ url_for('auth.logout') }}" class="block px-6 py-3 text-rose-600 hover:bg-rose-50">–í—ã–π—Ç–∏</a>
        {% else %}
          <a href="{{ url_for('auth.login') }}" class="block px-6 py-3 hover:bg-slate-50">–í–æ–π—Ç–∏</a>
          <a href="{{ url_for('auth.register') }}" class="block px-6 py-3 hover:bg-slate-50">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
        {% endif %}
      </div>
    </div>
  </nav>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="max-w-5xl mx-auto px-3 mt-4 space-y-2 relative z-10">
        {% for category, msg in messages %}
          {% set col = 'bg-emerald-50 border-emerald-200 text-emerald-800' if category in ['success','ok'] else
                       'bg-amber-50 border-amber-200 text-amber-800' if category in ['warning'] else
                       'bg-rose-50 border-rose-200 text-rose-800' if category in ['error','danger'] else
                       'bg-sky-50 border-sky-200 text-sky-800' %}
          <div class="glass border {{ col }} px-4 py-3 rounded-xl flex items-start gap-3">
            <div class="text-xl">‚ú®</div>
            <div class="font-semibold">{{ msg|safe }}</div>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  {% if show_hero is not defined or show_hero %}
    <header class="relative z-10 flex flex-col items-center justify-center pt-6 sm:pt-10 pb-4 sm:pb-6 text-center">
      <h1 class="hero-title text-3xl sm:text-5xl font-black tracking-tight mb-2 wedding-title-glow"
          style="letter-spacing:.02em;">
        –í—Å—ë –¥–ª—è –≤–∞—à–µ–π <span class="text-pink-500">–∏–¥–µ–∞–ª—å–Ω–æ–π —Å–≤–∞–¥—å–±—ã</span>
      </h1>
      <div class="mt-2 text-base sm:text-xl text-gray-700 max-w-2xl">
        –£–¥–æ–±–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É—á—ë—Ç–∞ –≥–æ—Å—Ç–µ–π, —Ä–∞—Å—Ö–æ–¥–æ–≤ –∏ –≤—Å–µ—Ö —Å–≤–∞–¥–µ–±–Ω—ã—Ö –∑–∞–±–æ—Ç.<br/>
        <span class="font-semibold text-pink-600/90">–û—Ä–≥–∞–Ω–∏–∑—É–π –ø—Ä–∞–∑–¥–Ω–∏–∫ —Å–≤–æ–µ–π –º–µ—á—Ç—ã –ª–µ–≥–∫–æ!</span>
      </div>
    </header>
  {% endif %}

  <main class="relative z-10 max-w-6xl mx-auto px-3 sm:px-4 py-4 sm:py-8">
    {% block content %}{% endblock %}
  </main>

  <footer class="relative z-10 mt-8 text-center text-gray-500 text-xs py-6 select-none">
    &copy; {{ 2025 }} –°–≤–∞–¥–µ–±–Ω—ã–π –ü–æ–º–æ—â–Ω–∏–∫ ‚Äî ok.shirinov <span class="text-pink-400">üíñ</span>
  </footer>

  <script>
  // –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—É–∑—ã—Ä–µ–π
  document.addEventListener('DOMContentLoaded', () => {
    const root = document.querySelector('.bg-decor');
    if (!root) return;

    const count = Math.min(48, Math.max(24, Math.floor(window.innerWidth / 20)));
    for (let i = 0; i < count; i++) {
      const b = document.createElement('div');
      b.className = 'bubble';

      const size = rand(28, 78);
      const left = rand(0, 100);
      const sway = rand(8, 18);
      const dur  = rand(18, 34);
      const delay = rand(-dur, 6);

      b.style.setProperty('--size',  size + 'px');
      b.style.setProperty('--left',  left + '%');
      b.style.setProperty('--sway',  sway + 'vw');
      b.style.setProperty('--dur',   dur + 's');
      b.style.setProperty('--delay', delay + 's');
      root.appendChild(b);
    }
    function rand(min, max){ return Math.random() * (max - min) + min }
  });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  {% block scripts %}{% endblock %}
</body>
</html>
